\documentclass[11pt]{article}
\usepackage[sc]{mathpazo}
\linespread{1.05}         % Palatino needs more leading (space between lines)
\usepackage[T1]{fontenc}
\usepackage{amssymb,verbatim,enumerate,amsmath,graphicx}
%\usepackage{latexsym}

\textwidth=6.5in
\textheight=9in
\topmargin=-.5in
                                                                               
\oddsidemargin=0in
\evensidemargin=0in

\def\be{\mathbf{e}}
\def\bq{\mathbf{q}}
\def\v{\mathbf{v}}
\def\bv{\mathbf{v}}
\def\x{\mathbf{x}}
\def\bx{\mathbf{x}}
\def\u{\mathbf{u}}
\def\y{\mathbf{y}}
\def\0{\mathbf{0}}
\def\cB{\mathcal{B}}
\def\cP{\mathcal{P}}
\def\cQ{\mathcal{Q}}
\def\QQ{\mathbb{Q}}
\def\RR{\mathbb{R}}
\def\ZZ{\mathbb{Z}}
\def\hopen{\mathbb{H}}
\newcommand\Ehr{\operatorname{Ehr}} 
\newcommand\conv{\operatorname{conv}} 
\newcommand\cone{\operatorname{cone}} 
\newcommand\vol{\operatorname{vol}} 
\DeclareMathOperator{\LH}{LH}

\def\open{$[${\tt research problem}$]$ }
\def\sage{$[${\tt sage}$]$ }

\begin{document}
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.4cm}

\pagestyle{empty}

\begin{center}
\Large{\bf Ehrhart Polynomials} 

\normalsize
VIII Encuentro Colombiano De Combinatoria
\end{center}

\paragraph{Day I: Appetizers}

\begin{enumerate}[(1)]
\vspace{-10pt}

\item Given integers
$a,b,c,d$, form the line segment $[(a,b), (c,d)] \subset \RR^2$ joining the points
$(a,b)$\index{line segment} and $(c,d)$. Show that the number of integer points on this line segment is $\gcd(a-c,b-d)+1$.

\item Prove that a triangle with vertices on the integer lattice has no other interior/boundary lattice points if and only if it has area $\frac 1 2$.\index{triangle}
(\emph{Hint:} You may begin by ``doubling'' the triangle to form a parallelogram.)

\item Pick four points in $\ZZ^3$ and let $\cP$ be their convex hull (in $\RR^3$). Compute the Ehrhart polynomial of~$\cP$.
(If you cannot think of a good example, consider the regular tetrahedron with vertices $\left( 0,0,0 \right) , \left( 1,1,0 \right)
, \left( 1,0,1 \right) , \left( 0,1,1 \right)$.)

\item Recall that the standard simplex $\Delta \in \RR^d$ is the convex hull of
the unit vectors and the origin. Verify that
\[ L_\Delta(t) = \binom{d+t} d \qquad \text{ and } \qquad L_{ \Delta^\circ }(t)
= \binom{t-1} d \, . \]
(If you'd like to amuse your colleagues, we can also write $L_{ \Delta^\circ
}(t) = (-1)^d \, \binom{d-t} d$.)

\def\Q{\mathcal Q}
\newcommand\DouPyr{\operatorname{BiPyr}} 
\def\v{{\bf v}}

\item Given a $(d-1)$-polytope $\Q$ with vertices $\v_1, \v_2, \dots, \v_m$
such that the origin is in $\Q$, we define the bipyramid $\DouPyr(\Q)$ over
$\Q$ as the convex hull of
\[
\left( \v_1, 0 \right) , \left( \v_2, 0 \right) , \dots, \left( \v_m, 0 \right) , \left( 0, \dots, 0, 1 \right) , \ \text{ and } \left( 0, \dots, 0, -1 \right) .
\]
Show that
$ \displaystyle
\Ehr_{ \DouPyr (\Q) } (z) \ = \ \frac{ 1+z }{ 1-z } \Ehr_\Q (z) \, .
$

\item Compute the Ehrhart polynomial of the octahedron
\[
  \Diamond \ = \ \left\{ \bx \in \RR^3 : \, \left| x_1 \right| + \left| x_2 \right| + \left| x_3 \right| \leq 1 \right\}
\]
via the four different approaches outlined in the lecture:
\begin{enumerate}
  \item triangulation into 8 standard tetrahedra \& their faces
(inclusion--exclusion);
  \item disjoint triangulation into 8 standard tetrahedra;
  \item \sage interpolation;
  \item \sage generating function.
\end{enumerate}
Generalize.

\item \sage Plot the roots of the Ehrhart polynomials of cross polytopes in
different dimensions. What's going on here?

\item \open Compute the Ehrhart polynomial of the Birkhoffâ€“-von Neumann polytope $\cB_{ 10 }$ or the
volume of $\cB_{ 11 }$. 

\newcommand\eulerco[2]{A \left( #1, #2 \right)} 
\item 
Define the Eulerian number
$\eulerco d k$ through\footnote{There are two slightly conflicting definitions of \emph{Eulerian numbers} in the literature: sometimes, they are defined through
$\sum_{ j \ge 0 } (j+1)^d \, z^j = \frac{ \sum_{ k=0 }^{ d } \eulerco d k z^{k}
}{ (1-z)^{ d+1 } }$ instead.}
\begin{equation*}
 \sum_{ j \ge 0 } j^d \, z^j \ = \ \frac{ \sum_{ k=0 }^{ d } \eulerco d k z^{k} }{ (1-z)^{ d+1 } } \, .
\end{equation*}
Alternatively, we may think of the polynomial $ \sum_{ k=0 }^{ d } \eulerco d k z^{k} $ is the numerator of the rational function
\[
 \left( z \frac{ d }{ dz } \right)^d \left( \frac{ 1 }{ 1-z } \right) \ = \ \underbrace{ z \frac{ d }{ dz } \cdots z \frac{ d }{ dz } }_{ d \text{ times } } \left( \frac{ 1 }{ 1-z } \right) .
\]
Prove the following:
\begin{align*}
\eulerco d k \ &= \ \eulerco d {d+1-k} ,  \\
\eulerco{ d }{ k } \ &= \ (d-k+1) \, \eulerco{ d-1 }{ k-1 } + k \, \eulerco{ d-1}{ k } , \\
\sum_{ k=0 }^{ d } \eulerco d k \ &= \ d! \, , \\
\eulerco d k \ &= \ \sum_{ j=0 }^{ k } (-1)^j \binom{ d+1 }{ j } (k-j)^d . 
\end{align*}

\item The permutahedron $\cP_d \in \RR^d$ is defined as the convex hull of
\[
  \left\{ \left( \pi(1) - 1, \, \pi(2) - 1, \dots, \, \pi(d) - 1 \right) : \, \pi \in S_d \right\} ,
\]
where $S_d$ is the set of all permutations of $\{ 1, 2, \dots, d \}$.
Show that $P_d$ is a zonotope:
\[ \cP_d = [\be_1, \be_2] + [\be_1, \be_3] + \dots + [\be_{ d-1 }, \be_d] \, ,\]
where $\be_1, \be_2, \dots, \be_d$ are the standard unit vectors.

\item Prove that $\cP_d$ tiles the hyperplane spanned by it.

\item Show that a sequence $f(n)$ is given by a polynomial of degree $\le d$ if and only if
    \[
        \sum_{ n \ge 0 } f(n) \, z^n \ = \ \frac{ h(z) }{ (1-z)^{ d+1 } }
    \]
    for some polynomial $h(z)$ of degree $\le d$.  Furthermore, $f(n)$ has
    degree $d$ if and only if $h(1) \ne 0$.

\end{enumerate}

% ========================================================

{\sc Matthias Beck} \hfill {\tt https://matthbeck.github.io/}

% ========================================================

\newpage
\begin{center}
\Large{\bf Ehrhart Polynomials} 

\normalsize
VIII Encuentro Colombiano De Combinatoria
\end{center}

\paragraph{Day II: Generating Functions \& Complexity}

\begin{enumerate}[(1)]
\vspace{-10pt}

\item Compute the generating functions for
\[
  P_{ \le n } := \left\{ \lambda \in \ZZ^n : \, 0 \le \lambda_1 \le \lambda_2 \le
\dots \le \lambda_n \right\} ,
\]
partitions into at most $n$ parts.
Adjust your computations for partitions into exactly $n$ parts.

\item Compute the integer-point transform of the cone
$
  \RR_{ \ge 0 } \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} + 
  \RR_{ \ge 0 } \begin{bmatrix} 0 \\ 1 \\ 1 \end{bmatrix} + 
  \RR_{ \ge 0 } \begin{bmatrix} 2 \\ 1 \\ 1 \end{bmatrix} \, .
$

\def\la{\lambda}

\item Let $n \ge 3$ and
\[
  T_n := \left\{ (\la_1, \dots , \la_n) \in \ZZ^n : \, \la_n \ge \cdots \ge \la_1 \ge 1 \ \text{ \rm and } \ \la_1 + \cdots + \la_{n-1} > \la_n \right\} ,
\]
the set of all ``$n$-gon partitions.''
\begin{enumerate}[(a)]
\item Compute the generating function for $T_3$.
\item What makes your computation more complicated for $n > 3$?
\item Compute the generating function for
\[
  \widetilde T_n := \left\{ (\la_1, \dots , \la_n) \in \ZZ^n : \, \la_n \ge \cdots
\ge \la_1 \ge 1 \ \text{ \rm and } \ \la_1 + \cdots + \la_{n-1} \le \la_n \right\} ,
\]
and conclude from it the generating function for $T_n$.
\end{enumerate}

\item 
Recall the lecture-hall partitions
\[
\LH_n \ := \ \left \{\lambda\in\ZZ^n:\, 0 \leq \frac{\lambda_{1}}{{1}}\leq
\frac{\lambda_{2}}{{2}} \leq \cdots\leq \frac{\lambda_{n}}{{n}}\right \} .
\]
Compute the generators of the underlying cone, and verify the first few instances of
the 
Lecture-Hall Theorem:
\[ \sum_{ \lambda \in \LH_n } q^{ \lambda_1 + \dots + \lambda_n } \ =
\ \frac{ 1 }{ (1-q) (1-q^3) \cdots (1-q^{ 2n-1 }) } \, . \] 

\item \sage Pick five points in $\ZZ^3$ and let $\cP$ be their convex hull (in $\RR^3$). Compute the Ehrhart polynomial of~$\cP$.

\item \open
Choose $d+1$ of the $2^d$ vertices of the unit $d$-cube, and let $\Delta$ be the simplex defined by their convex hull.
\begin{enumerate}[(a)]
\item Which choice of vertices maximizes $\vol \Delta$?
\item What is the maximum volume of such a $\Delta$?
\end{enumerate}

\item Give an explicit bijection between the faces (including $\varnothing$) of a
given polytope $\cP$ and the faces (excluding $\varnothing$) of its homogenization
$\cone(\cP)$.

\item Suppose $\cP \subset \RR^m$ and $\cQ \subset \RR^n$ are lattice polytopes.
Prove that the \emph{convolution} of their Ehrhart polynomials,
\[
  L(t) := \sum_{ s=0 }^t L_\cP(s) \, L_\cQ(t-s)
\]
equals the Ehrhart quasipolynomial of the polytope given by the convex hull of $\cP
\times \left\{ \0_n \right\} \times \left\{ 0 \right\}$ and $\left\{ \0_m \right\}
\times \cQ \times \left\{ 1 \right\} $. Here $\0_d$ denotes the origin in $\RR^d$.

\item Verify (parts of) the classification picture of degree-2 Ehrhart polynomials $c_2 t^2 + c_1 t + 1$: every
half-integral point in the figure below corresponds to an Ehrhart polynomial.

\begin{center}
\includegraphics[totalheight=3.5in]{../dim2cone}
\end{center}

\item \open Give the corresponding classification picture of degree-3 Ehrhart polynomials. 
 

\item This exercise constructs triangulations.
Given a polytope $\cP \subseteq \RR^d$ with vertices $\bv_1, \bv_2, \dots, \bv_n$, randomly choose $h_1, h_2,
\dots, h_n \in \RR$, and define the new polytope $\cQ \subseteq \RR^{ d+1 }$ as the convex hull of
$(\bv_1, h_1), (\bv_2, h_2), \dots, (\bv_n, h_n)$.
The \emph{lower hull} of $\cQ$ consists of all points that are \emph{visible from below}: all points $(x_1, x_2, \dots, x_{ d+1 }) \in \cQ$ for which there is no $\epsilon > 0$ such that $(x_1, x_2, \dots, x_{ d+1 } - \epsilon) \in \cQ$.
A \emph{lower face} of $\cQ$ is a face of $\cQ$ that is in the lower hull.
Let $\pi : \RR^{ d+1 } \to \RR^d$ be the projection that forgets the last coordinate. 
Show that all lower faces of $\cQ$ are simplices, and that their projections under $\pi$ form a triangulation of~$\cP$.

\end{enumerate}

% ========================================================

{\sc Matthias Beck} \hfill {\tt https://matthbeck.github.io/}

% ========================================================

\newpage
\begin{center}
\Large{\bf Ehrhart Polynomials} 

\normalsize
VIII Encuentro Colombiano De Combinatoria
\end{center}

\paragraph{Day III: Positivity, Reciprocity \& Friends}

\begin{enumerate}[(1)]
\vspace{-10pt}

\item Let $\cP \subset \RR^d$ be a full-dimensional polytope.
Show that there is no $\bq \in \RR^d$ such that $\hopen^\bq \cP = \cP$.

\item Let $\cP \subset \RR^d$ be a full-dimensional polyhedron with dissection $\cP = \cP_1 \cup \cP_2 \cup \cdots \cup \cP_m$.
If $\bq \in \RR^d$ is generic relative to each $\cP_i$, then
\[
  \hopen_\bq \cP \ = \ \hopen_\bq \cP_1 \uplus \hopen_\bq \cP_2 \uplus \cdots \uplus
\hopen_\bq \cP_m 
\]
and
\[
  \hopen^\bq \cP \ = \ \hopen^\bq \cP_1 \uplus \hopen^\bq \cP_2 \uplus \cdots \uplus
\hopen^\bq \cP_m \, .
\]

\def\Rnn{\RR_{ \ge 0 }} 
\newcommand\Chat{\widehat{\mathcal{K}}}
\newcommand\Ccheck{\widecheck{\mathcal{K}}}
\newcommand\C{\mathcal{K}}

\item Fix linearly independent vectors $\bv_1, \bv_2, \dots, \bv_d \in \ZZ^d$ and consider the simplicial cone
\[
  \C \ := \ \Rnn \bv_1 + \Rnn \bv_2 + \dots + \Rnn \bv_d \, .
\]
Prove that, for
\[
  \Chat \ := \ \Rnn \bv_1 + \dots + \Rnn \bv_{ m-1 } + \RR_{ >0 } \bv_m + \dots + \RR_{ >0 } \bv_d \, ,
\]
there exists $\bq \in \RR^d$ (generic relative to $\C$) such that
\[
  \Chat \ = \ \hopen_\bq \C \, .
\]
Conversely, show that, for every generic $\bq \in \RR^d$ relative to $\C$, the half-open cone $\hopen_\bq \C$ is of the form $\Chat$ for some reordering of the $\bv_j$s and some~$m$.

\item Prove Ehrhart's theorem for half-open lattice polytopes.

\item Let $S$ be an $m$-dimensional subset of $\RR^d$ (i.e., the affine span of $S$ has dimension $m$).
Then we define the \emph{relative volume} of $S$ to be
\[ \vol S \ := \ \lim_{ n \to \infty } \frac{ 1 }{ n^m } \left| n \, S \cap \ZZ^d \right| . \]
\begin{enumerate}[{\rm (a)}]
\item Convince yourself that $\vol S$ is the usual volume if $m = d$.
\item Show that, if $\Delta \subset \RR^d$ is an $m$-dimensional lattice
    simplex, then the leading coefficient of $L_\Delta(n)$
(i.e., the coefficient of $n^m$) equals $\vol \Delta$.
\end{enumerate}

\item \sage Give an example of a polynomial $f(n)$ with (some) negative coefficients whose corresponding generating function
numerator polynomial $h(z)$ has only positive coefficients.

\item \sage For a lattice polytope $\cP$, the numerator of the generating function is the \emph{$h^*$-polynomial} of $\cP$.
Give a non-unimodal\footnote{
A polynomial is \emph{unimodal} if its coefficients increase up to some point and
then decrease.
} example of an $h^*$-polynomial.

\item \open
Now let
$\cP = \left\{ \bx \in [0,1]^d : \, x_1 + x_2 + \dots + x_d = k \right\}$,
for your favorite integers $2 \le k \le d-2$. 
(This is the \emph{$(d, k)$-hypersimplex}.)
Prove that the $h^*$-polynomial of $\cP$ is unimodal.

\def\hs{h^*}

\item Let $\cP$ be a lattice $d$-polytope and write 
\[
    \Ehr_\cP (z) \ = \ \frac{ \hs_d \, z^d + \hs_{ d-1 } z^{ d-1 } + \dots +
    \hs_0 }{ (1-z)^{ d+1 } } \, .
\]
Prove that:
\begin{enumerate}[{\rm (a)}]
\item $\hs_d = \left| \cP^\circ \cap \ZZ^d \right| .$
\item $\hs_1 = \left| \cP \cap \ZZ^d \right| - d - 1 \, .$
\item $\hs_0 + \hs_1 + \dots + \hs_d = d! \vol(\cP) \, .$
\end{enumerate}

\item A \emph{reflexive polytope}
is a lattice polytope $\cP$ such that the origin is the unique interior lattice point of
$\cP$ and\footnote{More generally, if the $1$ on the right-hand side of \eqref{reflexivedef}
is replaced by an arbitrary fixed positive integer, we call $\cP$ \emph{Gorenstein}. You may
think about how this exercise can be extended to Gorenstein polytopes.}
\begin{equation}\label{reflexivedef}
  L_{ \cP^\circ } (n) \ = \ L_\cP (n-1)
  \qquad \text{ for all } n \in \ZZ_{ >0 }  \, .
\end{equation}
Prove that if $\cP$ is a lattice $d$-polytope that contains the origin in its interior and that has the Ehrhart series
\[
  \Ehr_\cP(z) \ = \ \frac{ h^*_d \, z^d + h^*_{ d-1 } \, z^{ d-1 } + \dots + h^*_1 \, z + h^*_0 }{ (1-z)^{ d+1 } } \, ,
\]
then $\cP$ is reflexive if and only if $ h^*_k = h^*_{ d-k }$ for all $0 \le k
\le \frac d 2$.

\item For any polynomial $h(z)$ of degree $d$, show there exist unique polynomials $a(z)$ and $b(z)$ such that
\[
  h(z) = a(z) + z \, b(z)
  \qquad \text{ where } \qquad a(z) = z^d \, a(\tfrac 1 z) \qquad \text{ and } \qquad b(z) = z^{ d-1 } \, b(\tfrac 1 z) \, .
\]
(There are many variations of this; e.g., we could leave out the $z$ factor in front of $b(z)$.)

\item Derive inequalities for the coefficients of $h(z)$ if we know that both $a(z)$ and $b(z)$ have only nonnegative
coefficients.

\end{enumerate}

\newpage
\begin{center}
\Large{\bf Ehrhart Polynomials} 

\normalsize
VIII Encuentro Colombiano De Combinatoria
\end{center}

\paragraph{Day IV: From $h$ to $h^*$}

\begin{enumerate}[(1)]
\vspace{-10pt}

\item If you haven't done so already, work on the last two exercises from yesterday.

\item Let $\hopen_\bq \Delta$ be a unimodular simplex with $r$ facets missing. Show that
$h^*_{\hopen_\bq \Delta } (z) = z^r$.
Use this to give an alternative description of the $h^*$-polynomial of a lattice polytope
that admits a unimodular triangulation.

\item Given a triangulation $T$ of the boundary of a $d$-polytope $\cP$ and a point $\v \in \cP^\circ$, construct a
triangulation $K$ of $\cP$ consisting of $T$ with the simplices $\conv(\Delta, \v)$ for all $\Delta \in T$ appended; i.e., the new triangulation $K$ comes from coning over $T$. Prove that
\[
h_K(z) = h_T(z) \, .
\]

\item A lattice polytope is polytope $\cP$ has the \emph{integer decomposition property (IDP)} if for every positive integer $k$ and every integer
point $\x \in k \cP$, there exist integer points $\y_1,\y_2,\dots,\y_k \in \cP$ such that $\y_1+\y_2+\dots+\y_k=\x$. Prove that every
polytope that admits a unimodular triangulation is IDP.

\item  Let $\cP$ be a $d$-dimensional lattice polytope. Show that if $T$ is a
    unimodular triangulation of $\cP$, then the $f$-vector of $T$ can be computed via
    \[
        f_{k-1} \ = \ \sum_{r=0}^k \binom{d+1-r}{k-r} \, h^*_r(\cP) 
    \]
and conclude that $f_T(z) = h^*_{ \cP^\circ } (z+1)$.

\item Under the same conditions as in the previous exercise, let $f_T^{ \rm int } (z)$ be the
polynomial whose $k$th coefficient counts the number of $k$-simplices that are not on the
boundary of $P$. Prove that $f_T^{ \rm int } (z) = h_\cP^*(z+1)$.

\item    Let $\Delta = \conv(\u_0,\dots,\u_{d}) \subset \RR^{d}$, $\Delta' =
    \conv(\v_0,\dots,\v_{e}) \subset \RR^{e}$ be two unimodular simplices
    and let $\cP = \Delta \times \Delta'$ be their Cartesian product.
    \begin{enumerate}[(a)]
        \item Show that any $(d+e)$-simplex spanned by the vertices of $\cP$
            is unimodular.
        \item We can identify the vertices of $\cP$ with the nodes of the
            square grid $\{0,\dots,d\} \times \{0,\dots,e\}$.  A
            \emph{lattice path} from $(0,0)$ to $(d,e)$ is a path on the
            grid that uses only unit steps $\rightarrow$ and $\uparrow$. Show
            that any such path encodes a unique $(d+e)$-simplex of $\cP$.
        \item Show that the collection of all such simplices yields a
            triangulation of~$\cP$.
        \item Compute the $h^*$-vector of~$\cP$.
    \end{enumerate}

\end{enumerate}

% ========================================================

{\sc Matthias Beck} \hfill {\tt https://matthbeck.github.io/}

% ========================================================

\end{document}

% ========================================================


